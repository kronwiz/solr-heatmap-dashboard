
hm_data = {};


function init () {
	var canvas = $( "#heatmap" ).get ( 0 );
	canvas.addEventListener ( "click", canvas_clicked, false );

	hm_data.canvas_left = canvas.offsetLeft;
	hm_data.canvas_top = canvas.offsetTop;

	$.ajax ( {
		"url": "/get-config?name=solr.rpt_field"

	} ).done ( function ( data ) {
		var results = JSON.parse ( data );

		hm_data.rpt_field = results [ "value" ];
	} )
}


function load_heatmap () {
	var conds = "";
	var disterrpct = $( "#disterrpct" ).val ();
	var disterr = $( "#disterr" ).val ();
	var gridlevel = $( "#gridlevel" ).val ();
	var geom = $( "#geom" ).val ();
	var q = $( "#query" ).val ();

	if ( q.trim ().length == 0 ) q = "*:*";
	conds = "q=" + q;

	conds += "&facet=true&facet.heatmap=" + hm_data.rpt_field;
	if ( $( "#disterrpct-flag" ).is ( ":checked" ) ) conds += "&facet.heatmap.distErrPct=" + disterrpct;
	if ( $( "#disterr-flag" ).is ( ":checked" ) ) conds += "&facet.heatmap.distErr=" + disterr;
	if ( $( "#gridlevel-flag" ).is ( ":checked" ) ) conds += "&facet.heatmap.gridLevel=" + gridlevel;
	if ( $( "#geom-flag" ).is ( ":checked" ) ) conds += "&facet.heatmap.geom=" + geom.trim ();

	$.ajax ( {
		"url": "/query?" + conds

	} ).done ( function ( data ) {
		$( "#datadump" ).val ( data );

		var results = JSON.parse ( data );

		if ( results [ "error" ] ) {
			// display error message
			$( "#errormsg" ).text ( results [ "error" ] [ "msg" ] );
			// clear canvas
			var canvas = $( "#heatmap" ).get ( 0 );
			canvas.width = 0;
			canvas.height = 0;

			return false;

		} else {
			// clear error message
			$( "#errormsg" ).text ( "" );
		};

		results = results [ "facet_counts" ] [ "facet_heatmaps" ] [ "location_rpt" ] ;
		fill_table ( results );
		draw_points ( results );
	} );

}


function fill_table ( facet ) {
	var i = 0;
	while ( facet [ i ] != "counts_ints2D" ) {
		if ( facet [ i ] == "gridLevel" ) $( "#gridlevel-value" ).text ( facet [ i + 1 ] );
		if ( facet [ i ] == "columns" ) {
			$( "#columns-value" ).text ( facet [ i + 1 ] );
			hm_data.columns = parseInt ( facet [ i + 1 ] );
		}
		if ( facet [ i ] == "rows" ) {
			$( "#rows-value" ).text ( facet [ i + 1 ] );
			hm_data.rows = parseInt ( facet [ i + 1 ] );
		}
		if ( facet [ i ] == "minX" ) {
			$( "#minx-value" ).text ( facet [ i + 1 ] );
			hm_data.minx = parseFloat ( facet [ i + 1 ] );
		}
		if ( facet [ i ] == "minY" ) {
			$( "#miny-value" ).text ( facet [ i + 1 ] );
			hm_data.miny = parseFloat ( facet [ i + 1 ] );
		}
		if ( facet [ i ] == "maxX" ) {
			$( "#maxx-value" ).text ( facet [ i + 1 ] );
			hm_data.maxx = parseFloat ( facet [ i + 1 ] );
		}
		if ( facet [ i ] == "maxY" ) {
			$( "#maxy-value" ).text ( facet [ i + 1 ] );
			hm_data.maxy = parseFloat ( facet [ i + 1 ] );
		}
		i++;
	}

	hm_data.cell_width = Math.abs ( hm_data.maxx - hm_data.minx ) / hm_data.columns;
	hm_data.cell_height = Math.abs ( hm_data.maxy - hm_data.miny ) / hm_data.rows;
}


function draw_points ( facet ) {
	var canvas = $( "#heatmap" ).get ( 0 );
	var hm = canvas.getContext ( "2d" );

	var i = 0;
	while ( facet [ i ] != "counts_ints2D" ) {
		if ( facet [ i ] == "columns" ) var columns = facet [ i + 1 ];
		if ( facet [ i ] == "rows" ) var rows = facet [ i + 1 ];
		i++;
	}

	var zoom = parseInt ( $( "#zoom" ).val () );
	hm_data.zoom = zoom;

	var COLORS = GRADIENTS [ $( "#colors" ).val () ];

	canvas.width = columns * zoom;
	canvas.height = rows * zoom;

	var total_colors = COLORS.length;
	var width = canvas.width;
	var data = facet [ i + 1 ];
	var pixels = hm.getImageData ( 0, 0, canvas.width, canvas.height );

	var max_cdata = 0;
	var min_cdata = 999999999;

	for ( var r = 0; r < rows; r++ ) {
		var rdata = data [ r ];
		if ( rdata == null ) continue;

		for ( var c = 0; c < columns; c++ ) {
			var cdata = rdata [ c ];

			// these are used only to be displayed
			max_cdata = Math.max ( cdata, max_cdata );
			min_cdata = Math.min ( cdata, min_cdata );

			var color = COLORS [ cdata % total_colors ];

			/*
			numero di elementi per pixel = 4 -> (r, g, b, a)
			larghezza di una riga del canvas nell'array = 4 * width

			quindi per andare a capo di una riga occorre sommare 4 * width
			e per spostarsi di un pixel occorre sommare 4 alla posizione corrente
			*/
			var offset = 4 * width * r * zoom + 4 * c * zoom;

			/*
			se sto ingrandendo devo disegnare dei quadrati larghi "zoom" a partire
			dal pixel in "offset"
			*/
			for ( var rz = 0; rz < zoom; rz++ ) {
				for ( var cz = 0; cz < zoom; cz++ ) {
					var zoomoff = 4 * width * rz + 4 * cz;
					pixels.data [ offset + zoomoff ] = color [ 0 ];
					pixels.data [ offset + zoomoff + 1 ] = color [ 1 ];
					pixels.data [ offset + zoomoff + 2 ] = color [ 2 ];
					pixels.data [ offset + zoomoff + 3 ] = 255;
				}
			}
		} // columns
	} // rows

	hm.putImageData ( pixels, 0, 0 );

	$( "#max-cell-value" ).text ( max_cdata );
	$( "#min-cell-value" ).text ( min_cdata );
}


function canvas_clicked ( ev ) {
	var conds = "";

	// event position in cell grid coordinates
	var col = Math.trunc ( ev.offsetX / hm_data.zoom );
	var row = Math.trunc ( ev.offsetY / hm_data.zoom );

	// cell boundaries in world coordinates
	var cminx = hm_data.minx + hm_data.cell_width * col; // it works because col starts from 0
	var cmaxx = cminx + hm_data.cell_width; // all cells are squares in our representation
	var cmaxy = hm_data.maxy - hm_data.cell_height * row; // it works because row starts from 0
	var cminy = cmaxy - hm_data.cell_height; // all cells are squares in our representation

	var q = $( "#query" ).val ();
	if ( q.trim ().length == 0 ) q = "*:*";
	conds = "q=" + q;

	var fl = $( "#fl" ).val ();
	if ( fl.trim ().length != 0 ) conds += "&fl=" + fl;

	// Note the quotes and the order of the coordinates
	conds += '&fq=' + hm_data.rpt_field + ':[ "' + cminy + ', ' + cminx + '" TO "' + cmaxy + ', ' + cmaxx + '" ]';

	$.ajax ( {
		"url": "/query?" + conds

	} ).done ( function ( data ) {
		var results = JSON.parse ( data );

		if ( results [ "error" ] ) {
			// display error message
			$( "#errormsg" ).text ( results [ "error" ] [ "msg" ] );
			return false;

		} else {
			// clear error message
			$( "#errormsg" ).text ( "" );
		};

		var docs = results [ "response" ] [ "docs" ];

		if ( docs.length == 0 ) return;

		var records = [];
		for ( var i = 0; i < docs.length; i++ ) {
			records.push ( JSON.stringify ( docs [ i ] ) );
		}

		alert ( records.join ( "\n" ) + "\n\nCell row: " + row + ", col: " + col + '\nBoudaries: [ "' + cminy + ', ' + cminx + '" TO "' + cmaxy + ', ' + cmaxx + '" ]' );
	} );

}


var GRADIENTS = {
	"16":
// {{{ COLORS16
[ [ 255, 255, 255 ], [ 191, 195, 255 ], [ 127, 136, 255 ], [ 63, 76, 255 ], [ 0, 17, 255 ], [ 0, 76, 214 ], [ 0, 136, 174 ], [ 0, 195, 134 ], [ 0, 255, 94 ], [ 63, 253, 70 ], [ 127, 251, 47 ], [ 191, 249, 23 ], [ 255, 247, 0 ], [ 255, 165, 1 ], [ 255, 84, 2 ], [ 255, 3, 3 ] ]
// }}}
	,
	"32":
// {{{ COLORS32
[ [ 255, 255, 255 ], [ 223, 225, 255 ], [ 191, 195, 255 ], [ 159, 165, 255 ], [ 127, 136, 255 ], [ 95, 106, 255 ], [ 63, 76, 255 ], [ 31, 46, 255 ], [ 0, 17, 255 ], [ 0, 46, 234 ], [ 0, 76, 214 ], [ 0, 106, 194 ], [ 0, 136, 174 ], [ 0, 165, 154 ], [ 0, 195, 134 ], [ 0, 225, 114 ], [ 0, 255, 94 ], [ 31, 254, 82 ], [ 63, 253, 70 ], [ 95, 252, 58 ], [ 127, 251, 47 ], [ 159, 250, 35 ], [ 191, 249, 23 ], [ 223, 248, 11 ], [ 255, 247, 0 ], [ 255, 212, 0 ], [ 255, 177, 0 ], [ 255, 142, 1 ], [ 255, 107, 1 ], [ 255, 72, 2 ], [ 255, 37, 2 ], [ 255, 3, 3 ] ]
// }}}
	,
	"64":
// {{{ COLORS64
[ [ 255, 255, 255 ], [ 239, 240, 255 ], [ 223, 225, 255 ], [ 207, 210, 255 ], [ 191, 195, 255 ], [ 175, 180, 255 ], [ 159, 165, 255 ], [ 143, 150, 255 ], [ 127, 136, 255 ], [ 111, 121, 255 ], [ 95, 106, 255 ], [ 79, 91, 255 ], [ 63, 76, 255 ], [ 47, 61, 255 ], [ 31, 46, 255 ], [ 15, 31, 255 ], [ 0, 17, 255 ], [ 0, 31, 244 ], [ 0, 46, 234 ], [ 0, 61, 224 ], [ 0, 76, 214 ], [ 0, 91, 204 ], [ 0, 106, 194 ], [ 0, 121, 184 ], [ 0, 136, 174 ], [ 0, 150, 164 ], [ 0, 165, 154 ], [ 0, 180, 144 ], [ 0, 195, 134 ], [ 0, 210, 124 ], [ 0, 225, 114 ], [ 0, 240, 104 ], [ 0, 255, 94 ], [ 15, 254, 88 ], [ 31, 254, 82 ], [ 47, 253, 76 ], [ 63, 253, 70 ], [ 79, 252, 64 ], [ 95, 252, 58 ], [ 111, 251, 52 ], [ 127, 251, 47 ], [ 143, 250, 41 ], [ 159, 250, 35 ], [ 175, 249, 29 ], [ 191, 249, 23 ], [ 207, 248, 17 ], [ 223, 248, 11 ], [ 239, 247, 5 ], [ 255, 247, 0 ], [ 255, 230, 0 ], [ 255, 214, 0 ], [ 255, 198, 0 ], [ 255, 181, 0 ], [ 255, 165, 1 ], [ 255, 149, 1 ], [ 255, 133, 1 ], [ 255, 116, 1 ], [ 255, 100, 1 ], [ 255, 84, 2 ], [ 255, 68, 2 ], [ 255, 51, 2 ], [ 255, 35, 2 ], [ 255, 19, 2 ], [ 255, 3, 3 ] ]
// }}}
	,
	"128":
// {{{ COLORS128
[ [ 255, 255, 255 ], [ 247, 247, 255 ], [ 239, 240, 255 ], [ 231, 232, 255 ], [ 223, 225, 255 ], [ 215, 217, 255 ], [ 207, 210, 255 ], [ 199, 202, 255 ], [ 191, 195, 255 ], [ 183, 188, 255 ], [ 175, 180, 255 ], [ 167, 173, 255 ], [ 159, 165, 255 ], [ 151, 158, 255 ], [ 143, 150, 255 ], [ 135, 143, 255 ], [ 127, 136, 255 ], [ 119, 128, 255 ], [ 111, 121, 255 ], [ 103, 113, 255 ], [ 95, 106, 255 ], [ 87, 98, 255 ], [ 79, 91, 255 ], [ 71, 83, 255 ], [ 63, 76, 255 ], [ 55, 69, 255 ], [ 47, 61, 255 ], [ 39, 54, 255 ], [ 31, 46, 255 ], [ 23, 39, 255 ], [ 15, 31, 255 ], [ 7, 24, 255 ], [ 0, 17, 255 ], [ 0, 24, 249 ], [ 0, 31, 244 ], [ 0, 39, 239 ], [ 0, 46, 234 ], [ 0, 54, 229 ], [ 0, 61, 224 ], [ 0, 69, 219 ], [ 0, 76, 214 ], [ 0, 83, 209 ], [ 0, 91, 204 ], [ 0, 98, 199 ], [ 0, 106, 194 ], [ 0, 113, 189 ], [ 0, 121, 184 ], [ 0, 128, 179 ], [ 0, 136, 174 ], [ 0, 143, 169 ], [ 0, 150, 164 ], [ 0, 158, 159 ], [ 0, 165, 154 ], [ 0, 173, 149 ], [ 0, 180, 144 ], [ 0, 188, 139 ], [ 0, 195, 134 ], [ 0, 202, 129 ], [ 0, 210, 124 ], [ 0, 217, 119 ], [ 0, 225, 114 ], [ 0, 232, 109 ], [ 0, 240, 104 ], [ 0, 247, 99 ], [ 0, 255, 94 ], [ 7, 254, 91 ], [ 15, 254, 88 ], [ 23, 254, 85 ], [ 31, 254, 82 ], [ 39, 253, 79 ], [ 47, 253, 76 ], [ 55, 253, 73 ], [ 63, 253, 70 ], [ 71, 252, 67 ], [ 79, 252, 64 ], [ 87, 252, 61 ], [ 95, 252, 58 ], [ 103, 251, 55 ], [ 111, 251, 52 ], [ 119, 251, 49 ], [ 127, 251, 47 ], [ 135, 250, 44 ], [ 143, 250, 41 ], [ 151, 250, 38 ], [ 159, 250, 35 ], [ 167, 249, 32 ], [ 175, 249, 29 ], [ 183, 249, 26 ], [ 191, 249, 23 ], [ 199, 248, 20 ], [ 207, 248, 17 ], [ 215, 248, 14 ], [ 223, 248, 11 ], [ 231, 247, 8 ], [ 239, 247, 5 ], [ 247, 247, 2 ], [ 255, 247, 0 ], [ 255, 239, 0 ], [ 255, 231, 0 ], [ 255, 223, 0 ], [ 255, 215, 0 ], [ 255, 207, 0 ], [ 255, 199, 0 ], [ 255, 191, 0 ], [ 255, 184, 0 ], [ 255, 176, 0 ], [ 255, 168, 0 ], [ 255, 160, 1 ], [ 255, 152, 1 ], [ 255, 144, 1 ], [ 255, 136, 1 ], [ 255, 128, 1 ], [ 255, 121, 1 ], [ 255, 113, 1 ], [ 255, 105, 1 ], [ 255, 97, 1 ], [ 255, 89, 1 ], [ 255, 81, 2 ], [ 255, 73, 2 ], [ 255, 65, 2 ], [ 255, 58, 2 ], [ 255, 50, 2 ], [ 255, 42, 2 ], [ 255, 34, 2 ], [ 255, 26, 2 ], [ 255, 18, 2 ], [ 255, 10, 2 ], [ 255, 3, 3 ] ]
// }}}
	,
	"256":
// {{{ COLORS256
[ [ 255, 255, 255 ], [ 251, 251, 255 ], [ 247, 247, 255 ], [ 243, 243, 255 ], [ 239, 240, 255 ], [ 235, 236, 255 ], [ 231, 232, 255 ], [ 227, 228, 255 ], [ 223, 225, 255 ], [ 219, 221, 255 ], [ 215, 217, 255 ], [ 211, 214, 255 ], [ 207, 210, 255 ], [ 203, 206, 255 ], [ 199, 202, 255 ], [ 195, 199, 255 ], [ 191, 195, 255 ], [ 187, 191, 255 ], [ 183, 188, 255 ], [ 179, 184, 255 ], [ 175, 180, 255 ], [ 171, 176, 255 ], [ 167, 173, 255 ], [ 163, 169, 255 ], [ 159, 165, 255 ], [ 155, 162, 255 ], [ 151, 158, 255 ], [ 147, 154, 255 ], [ 143, 150, 255 ], [ 139, 147, 255 ], [ 135, 143, 255 ], [ 131, 139, 255 ], [ 127, 136, 255 ], [ 123, 132, 255 ], [ 119, 128, 255 ], [ 115, 124, 255 ], [ 111, 121, 255 ], [ 107, 117, 255 ], [ 103, 113, 255 ], [ 99, 109, 255 ], [ 95, 106, 255 ], [ 91, 102, 255 ], [ 87, 98, 255 ], [ 83, 95, 255 ], [ 79, 91, 255 ], [ 75, 87, 255 ], [ 71, 83, 255 ], [ 67, 80, 255 ], [ 63, 76, 255 ], [ 59, 72, 255 ], [ 55, 69, 255 ], [ 51, 65, 255 ], [ 47, 61, 255 ], [ 43, 57, 255 ], [ 39, 54, 255 ], [ 35, 50, 255 ], [ 31, 46, 255 ], [ 27, 43, 255 ], [ 23, 39, 255 ], [ 19, 35, 255 ], [ 15, 31, 255 ], [ 11, 28, 255 ], [ 7, 24, 255 ], [ 3, 20, 255 ], [ 0, 17, 255 ], [ 0, 20, 252 ], [ 0, 24, 249 ], [ 0, 28, 247 ], [ 0, 31, 244 ], [ 0, 35, 242 ], [ 0, 39, 239 ], [ 0, 43, 237 ], [ 0, 46, 234 ], [ 0, 50, 232 ], [ 0, 54, 229 ], [ 0, 57, 227 ], [ 0, 61, 224 ], [ 0, 65, 222 ], [ 0, 69, 219 ], [ 0, 72, 217 ], [ 0, 76, 214 ], [ 0, 80, 212 ], [ 0, 83, 209 ], [ 0, 87, 207 ], [ 0, 91, 204 ], [ 0, 95, 202 ], [ 0, 98, 199 ], [ 0, 102, 197 ], [ 0, 106, 194 ], [ 0, 109, 192 ], [ 0, 113, 189 ], [ 0, 117, 187 ], [ 0, 121, 184 ], [ 0, 124, 182 ], [ 0, 128, 179 ], [ 0, 132, 177 ], [ 0, 136, 174 ], [ 0, 139, 171 ], [ 0, 143, 169 ], [ 0, 147, 166 ], [ 0, 150, 164 ], [ 0, 154, 161 ], [ 0, 158, 159 ], [ 0, 162, 156 ], [ 0, 165, 154 ], [ 0, 169, 151 ], [ 0, 173, 149 ], [ 0, 176, 146 ], [ 0, 180, 144 ], [ 0, 184, 141 ], [ 0, 188, 139 ], [ 0, 191, 136 ], [ 0, 195, 134 ], [ 0, 199, 131 ], [ 0, 202, 129 ], [ 0, 206, 126 ], [ 0, 210, 124 ], [ 0, 214, 121 ], [ 0, 217, 119 ], [ 0, 221, 116 ], [ 0, 225, 114 ], [ 0, 228, 111 ], [ 0, 232, 109 ], [ 0, 236, 106 ], [ 0, 240, 104 ], [ 0, 243, 101 ], [ 0, 247, 99 ], [ 0, 251, 96 ], [ 0, 255, 94 ], [ 3, 254, 92 ], [ 7, 254, 91 ], [ 11, 254, 89 ], [ 15, 254, 88 ], [ 19, 254, 86 ], [ 23, 254, 85 ], [ 27, 254, 83 ], [ 31, 254, 82 ], [ 35, 253, 80 ], [ 39, 253, 79 ], [ 43, 253, 77 ], [ 47, 253, 76 ], [ 51, 253, 74 ], [ 55, 253, 73 ], [ 59, 253, 71 ], [ 63, 253, 70 ], [ 67, 252, 69 ], [ 71, 252, 67 ], [ 75, 252, 66 ], [ 79, 252, 64 ], [ 83, 252, 63 ], [ 87, 252, 61 ], [ 91, 252, 60 ], [ 95, 252, 58 ], [ 99, 251, 57 ], [ 103, 251, 55 ], [ 107, 251, 54 ], [ 111, 251, 52 ], [ 115, 251, 51 ], [ 119, 251, 49 ], [ 123, 251, 48 ], [ 127, 251, 47 ], [ 131, 250, 45 ], [ 135, 250, 44 ], [ 139, 250, 42 ], [ 143, 250, 41 ], [ 147, 250, 39 ], [ 151, 250, 38 ], [ 155, 250, 36 ], [ 159, 250, 35 ], [ 163, 249, 33 ], [ 167, 249, 32 ], [ 171, 249, 30 ], [ 175, 249, 29 ], [ 179, 249, 27 ], [ 183, 249, 26 ], [ 187, 249, 24 ], [ 191, 249, 23 ], [ 195, 248, 22 ], [ 199, 248, 20 ], [ 203, 248, 19 ], [ 207, 248, 17 ], [ 211, 248, 16 ], [ 215, 248, 14 ], [ 219, 248, 13 ], [ 223, 248, 11 ], [ 227, 247, 10 ], [ 231, 247, 8 ], [ 235, 247, 7 ], [ 239, 247, 5 ], [ 243, 247, 4 ], [ 247, 247, 2 ], [ 251, 247, 1 ], [ 255, 247, 0 ], [ 255, 243, 0 ], [ 255, 239, 0 ], [ 255, 235, 0 ], [ 255, 231, 0 ], [ 255, 227, 0 ], [ 255, 223, 0 ], [ 255, 219, 0 ], [ 255, 216, 0 ], [ 255, 212, 0 ], [ 255, 208, 0 ], [ 255, 204, 0 ], [ 255, 200, 0 ], [ 255, 196, 0 ], [ 255, 192, 0 ], [ 255, 188, 0 ], [ 255, 185, 0 ], [ 255, 181, 0 ], [ 255, 177, 0 ], [ 255, 173, 0 ], [ 255, 169, 0 ], [ 255, 165, 1 ], [ 255, 161, 1 ], [ 255, 157, 1 ], [ 255, 154, 1 ], [ 255, 150, 1 ], [ 255, 146, 1 ], [ 255, 142, 1 ], [ 255, 138, 1 ], [ 255, 134, 1 ], [ 255, 130, 1 ], [ 255, 126, 1 ], [ 255, 123, 1 ], [ 255, 119, 1 ], [ 255, 115, 1 ], [ 255, 111, 1 ], [ 255, 107, 1 ], [ 255, 103, 1 ], [ 255, 99, 1 ], [ 255, 95, 1 ], [ 255, 92, 1 ], [ 255, 88, 1 ], [ 255, 84, 2 ], [ 255, 80, 2 ], [ 255, 76, 2 ], [ 255, 72, 2 ], [ 255, 68, 2 ], [ 255, 64, 2 ], [ 255, 61, 2 ], [ 255, 57, 2 ], [ 255, 53, 2 ], [ 255, 49, 2 ], [ 255, 45, 2 ], [ 255, 41, 2 ], [ 255, 37, 2 ], [ 255, 33, 2 ], [ 255, 30, 2 ], [ 255, 26, 2 ], [ 255, 22, 2 ], [ 255, 18, 2 ], [ 255, 14, 2 ], [ 255, 10, 2 ], [ 255, 6, 2 ], [ 255, 3, 3 ] ]
// }}}
	,
	"512":
// {{{ COLORS512
[ [ 255, 255, 255 ], [ 253, 253, 255 ], [ 251, 251, 255 ], [ 249, 249, 255 ], [ 247, 247, 255 ], [ 245, 245, 255 ], [ 243, 243, 255 ], [ 241, 241, 255 ], [ 239, 240, 255 ], [ 237, 238, 255 ], [ 235, 236, 255 ], [ 233, 234, 255 ], [ 231, 232, 255 ], [ 229, 230, 255 ], [ 227, 228, 255 ], [ 225, 227, 255 ], [ 223, 225, 255 ], [ 221, 223, 255 ], [ 219, 221, 255 ], [ 217, 219, 255 ], [ 215, 217, 255 ], [ 213, 215, 255 ], [ 211, 214, 255 ], [ 209, 212, 255 ], [ 207, 210, 255 ], [ 205, 208, 255 ], [ 203, 206, 255 ], [ 201, 204, 255 ], [ 199, 202, 255 ], [ 197, 201, 255 ], [ 195, 199, 255 ], [ 193, 197, 255 ], [ 191, 195, 255 ], [ 189, 193, 255 ], [ 187, 191, 255 ], [ 185, 189, 255 ], [ 183, 188, 255 ], [ 181, 186, 255 ], [ 179, 184, 255 ], [ 177, 182, 255 ], [ 175, 180, 255 ], [ 173, 178, 255 ], [ 171, 176, 255 ], [ 169, 175, 255 ], [ 167, 173, 255 ], [ 165, 171, 255 ], [ 163, 169, 255 ], [ 161, 167, 255 ], [ 159, 165, 255 ], [ 157, 163, 255 ], [ 155, 162, 255 ], [ 153, 160, 255 ], [ 151, 158, 255 ], [ 149, 156, 255 ], [ 147, 154, 255 ], [ 145, 152, 255 ], [ 143, 150, 255 ], [ 141, 149, 255 ], [ 139, 147, 255 ], [ 137, 145, 255 ], [ 135, 143, 255 ], [ 133, 141, 255 ], [ 131, 139, 255 ], [ 129, 137, 255 ], [ 127, 136, 255 ], [ 125, 134, 255 ], [ 123, 132, 255 ], [ 121, 130, 255 ], [ 119, 128, 255 ], [ 117, 126, 255 ], [ 115, 124, 255 ], [ 113, 122, 255 ], [ 111, 121, 255 ], [ 109, 119, 255 ], [ 107, 117, 255 ], [ 105, 115, 255 ], [ 103, 113, 255 ], [ 101, 111, 255 ], [ 99, 109, 255 ], [ 97, 108, 255 ], [ 95, 106, 255 ], [ 93, 104, 255 ], [ 91, 102, 255 ], [ 89, 100, 255 ], [ 87, 98, 255 ], [ 85, 96, 255 ], [ 83, 95, 255 ], [ 81, 93, 255 ], [ 79, 91, 255 ], [ 77, 89, 255 ], [ 75, 87, 255 ], [ 73, 85, 255 ], [ 71, 83, 255 ], [ 69, 82, 255 ], [ 67, 80, 255 ], [ 65, 78, 255 ], [ 63, 76, 255 ], [ 61, 74, 255 ], [ 59, 72, 255 ], [ 57, 70, 255 ], [ 55, 69, 255 ], [ 53, 67, 255 ], [ 51, 65, 255 ], [ 49, 63, 255 ], [ 47, 61, 255 ], [ 45, 59, 255 ], [ 43, 57, 255 ], [ 41, 56, 255 ], [ 39, 54, 255 ], [ 37, 52, 255 ], [ 35, 50, 255 ], [ 33, 48, 255 ], [ 31, 46, 255 ], [ 29, 44, 255 ], [ 27, 43, 255 ], [ 25, 41, 255 ], [ 23, 39, 255 ], [ 21, 37, 255 ], [ 19, 35, 255 ], [ 17, 33, 255 ], [ 15, 31, 255 ], [ 13, 30, 255 ], [ 11, 28, 255 ], [ 9, 26, 255 ], [ 7, 24, 255 ], [ 5, 22, 255 ], [ 3, 20, 255 ], [ 1, 18, 255 ], [ 0, 17, 255 ], [ 0, 18, 253 ], [ 0, 20, 252 ], [ 0, 22, 251 ], [ 0, 24, 249 ], [ 0, 26, 248 ], [ 0, 28, 247 ], [ 0, 30, 246 ], [ 0, 31, 244 ], [ 0, 33, 243 ], [ 0, 35, 242 ], [ 0, 37, 241 ], [ 0, 39, 239 ], [ 0, 41, 238 ], [ 0, 43, 237 ], [ 0, 44, 236 ], [ 0, 46, 234 ], [ 0, 48, 233 ], [ 0, 50, 232 ], [ 0, 52, 231 ], [ 0, 54, 229 ], [ 0, 56, 228 ], [ 0, 57, 227 ], [ 0, 59, 226 ], [ 0, 61, 224 ], [ 0, 63, 223 ], [ 0, 65, 222 ], [ 0, 67, 221 ], [ 0, 69, 219 ], [ 0, 70, 218 ], [ 0, 72, 217 ], [ 0, 74, 216 ], [ 0, 76, 214 ], [ 0, 78, 213 ], [ 0, 80, 212 ], [ 0, 82, 210 ], [ 0, 83, 209 ], [ 0, 85, 208 ], [ 0, 87, 207 ], [ 0, 89, 205 ], [ 0, 91, 204 ], [ 0, 93, 203 ], [ 0, 95, 202 ], [ 0, 96, 200 ], [ 0, 98, 199 ], [ 0, 100, 198 ], [ 0, 102, 197 ], [ 0, 104, 195 ], [ 0, 106, 194 ], [ 0, 108, 193 ], [ 0, 109, 192 ], [ 0, 111, 190 ], [ 0, 113, 189 ], [ 0, 115, 188 ], [ 0, 117, 187 ], [ 0, 119, 185 ], [ 0, 121, 184 ], [ 0, 122, 183 ], [ 0, 124, 182 ], [ 0, 126, 180 ], [ 0, 128, 179 ], [ 0, 130, 178 ], [ 0, 132, 177 ], [ 0, 134, 175 ], [ 0, 136, 174 ], [ 0, 137, 173 ], [ 0, 139, 171 ], [ 0, 141, 170 ], [ 0, 143, 169 ], [ 0, 145, 168 ], [ 0, 147, 166 ], [ 0, 149, 165 ], [ 0, 150, 164 ], [ 0, 152, 163 ], [ 0, 154, 161 ], [ 0, 156, 160 ], [ 0, 158, 159 ], [ 0, 160, 158 ], [ 0, 162, 156 ], [ 0, 163, 155 ], [ 0, 165, 154 ], [ 0, 167, 153 ], [ 0, 169, 151 ], [ 0, 171, 150 ], [ 0, 173, 149 ], [ 0, 175, 148 ], [ 0, 176, 146 ], [ 0, 178, 145 ], [ 0, 180, 144 ], [ 0, 182, 143 ], [ 0, 184, 141 ], [ 0, 186, 140 ], [ 0, 188, 139 ], [ 0, 189, 138 ], [ 0, 191, 136 ], [ 0, 193, 135 ], [ 0, 195, 134 ], [ 0, 197, 132 ], [ 0, 199, 131 ], [ 0, 201, 130 ], [ 0, 202, 129 ], [ 0, 204, 127 ], [ 0, 206, 126 ], [ 0, 208, 125 ], [ 0, 210, 124 ], [ 0, 212, 122 ], [ 0, 214, 121 ], [ 0, 215, 120 ], [ 0, 217, 119 ], [ 0, 219, 117 ], [ 0, 221, 116 ], [ 0, 223, 115 ], [ 0, 225, 114 ], [ 0, 227, 112 ], [ 0, 228, 111 ], [ 0, 230, 110 ], [ 0, 232, 109 ], [ 0, 234, 107 ], [ 0, 236, 106 ], [ 0, 238, 105 ], [ 0, 240, 104 ], [ 0, 241, 102 ], [ 0, 243, 101 ], [ 0, 245, 100 ], [ 0, 247, 99 ], [ 0, 249, 97 ], [ 0, 251, 96 ], [ 0, 253, 95 ], [ 0, 255, 94 ], [ 1, 254, 93 ], [ 3, 254, 92 ], [ 5, 254, 91 ], [ 7, 254, 91 ], [ 9, 254, 90 ], [ 11, 254, 89 ], [ 13, 254, 88 ], [ 15, 254, 88 ], [ 17, 254, 87 ], [ 19, 254, 86 ], [ 21, 254, 85 ], [ 23, 254, 85 ], [ 25, 254, 84 ], [ 27, 254, 83 ], [ 29, 254, 82 ], [ 31, 254, 82 ], [ 33, 253, 81 ], [ 35, 253, 80 ], [ 37, 253, 80 ], [ 39, 253, 79 ], [ 41, 253, 78 ], [ 43, 253, 77 ], [ 45, 253, 77 ], [ 47, 253, 76 ], [ 49, 253, 75 ], [ 51, 253, 74 ], [ 53, 253, 74 ], [ 55, 253, 73 ], [ 57, 253, 72 ], [ 59, 253, 71 ], [ 61, 253, 71 ], [ 63, 253, 70 ], [ 65, 252, 69 ], [ 67, 252, 69 ], [ 69, 252, 68 ], [ 71, 252, 67 ], [ 73, 252, 66 ], [ 75, 252, 66 ], [ 77, 252, 65 ], [ 79, 252, 64 ], [ 81, 252, 63 ], [ 83, 252, 63 ], [ 85, 252, 62 ], [ 87, 252, 61 ], [ 89, 252, 60 ], [ 91, 252, 60 ], [ 93, 252, 59 ], [ 95, 252, 58 ], [ 97, 251, 58 ], [ 99, 251, 57 ], [ 101, 251, 56 ], [ 103, 251, 55 ], [ 105, 251, 55 ], [ 107, 251, 54 ], [ 109, 251, 53 ], [ 111, 251, 52 ], [ 113, 251, 52 ], [ 115, 251, 51 ], [ 117, 251, 50 ], [ 119, 251, 49 ], [ 121, 251, 49 ], [ 123, 251, 48 ], [ 125, 251, 47 ], [ 127, 251, 47 ], [ 129, 250, 46 ], [ 131, 250, 45 ], [ 133, 250, 44 ], [ 135, 250, 44 ], [ 137, 250, 43 ], [ 139, 250, 42 ], [ 141, 250, 41 ], [ 143, 250, 41 ], [ 145, 250, 40 ], [ 147, 250, 39 ], [ 149, 250, 38 ], [ 151, 250, 38 ], [ 153, 250, 37 ], [ 155, 250, 36 ], [ 157, 250, 35 ], [ 159, 250, 35 ], [ 161, 249, 34 ], [ 163, 249, 33 ], [ 165, 249, 33 ], [ 167, 249, 32 ], [ 169, 249, 31 ], [ 171, 249, 30 ], [ 173, 249, 30 ], [ 175, 249, 29 ], [ 177, 249, 28 ], [ 179, 249, 27 ], [ 181, 249, 27 ], [ 183, 249, 26 ], [ 185, 249, 25 ], [ 187, 249, 24 ], [ 189, 249, 24 ], [ 191, 249, 23 ], [ 193, 248, 22 ], [ 195, 248, 22 ], [ 197, 248, 21 ], [ 199, 248, 20 ], [ 201, 248, 19 ], [ 203, 248, 19 ], [ 205, 248, 18 ], [ 207, 248, 17 ], [ 209, 248, 16 ], [ 211, 248, 16 ], [ 213, 248, 15 ], [ 215, 248, 14 ], [ 217, 248, 13 ], [ 219, 248, 13 ], [ 221, 248, 12 ], [ 223, 248, 11 ], [ 225, 247, 11 ], [ 227, 247, 10 ], [ 229, 247, 9 ], [ 231, 247, 8 ], [ 233, 247, 8 ], [ 235, 247, 7 ], [ 237, 247, 6 ], [ 239, 247, 5 ], [ 241, 247, 5 ], [ 243, 247, 4 ], [ 245, 247, 3 ], [ 247, 247, 2 ], [ 249, 247, 2 ], [ 251, 247, 1 ], [ 253, 247, 0 ], [ 255, 247, 0 ], [ 255, 245, 0 ], [ 255, 243, 0 ], [ 255, 241, 0 ], [ 255, 239, 0 ], [ 255, 237, 0 ], [ 255, 235, 0 ], [ 255, 233, 0 ], [ 255, 231, 0 ], [ 255, 229, 0 ], [ 255, 227, 0 ], [ 255, 225, 0 ], [ 255, 223, 0 ], [ 255, 222, 0 ], [ 255, 220, 0 ], [ 255, 218, 0 ], [ 255, 216, 0 ], [ 255, 214, 0 ], [ 255, 212, 0 ], [ 255, 210, 0 ], [ 255, 208, 0 ], [ 255, 206, 0 ], [ 255, 204, 0 ], [ 255, 202, 0 ], [ 255, 200, 0 ], [ 255, 198, 0 ], [ 255, 197, 0 ], [ 255, 195, 0 ], [ 255, 193, 0 ], [ 255, 191, 0 ], [ 255, 189, 0 ], [ 255, 187, 0 ], [ 255, 185, 0 ], [ 255, 183, 0 ], [ 255, 181, 0 ], [ 255, 179, 0 ], [ 255, 177, 0 ], [ 255, 175, 0 ], [ 255, 173, 0 ], [ 255, 172, 0 ], [ 255, 170, 0 ], [ 255, 168, 0 ], [ 255, 166, 0 ], [ 255, 164, 1 ], [ 255, 162, 1 ], [ 255, 160, 1 ], [ 255, 158, 1 ], [ 255, 156, 1 ], [ 255, 154, 1 ], [ 255, 152, 1 ], [ 255, 150, 1 ], [ 255, 149, 1 ], [ 255, 147, 1 ], [ 255, 145, 1 ], [ 255, 143, 1 ], [ 255, 141, 1 ], [ 255, 139, 1 ], [ 255, 137, 1 ], [ 255, 135, 1 ], [ 255, 133, 1 ], [ 255, 131, 1 ], [ 255, 129, 1 ], [ 255, 127, 1 ], [ 255, 125, 1 ], [ 255, 124, 1 ], [ 255, 122, 1 ], [ 255, 120, 1 ], [ 255, 118, 1 ], [ 255, 116, 1 ], [ 255, 114, 1 ], [ 255, 112, 1 ], [ 255, 110, 1 ], [ 255, 108, 1 ], [ 255, 106, 1 ], [ 255, 104, 1 ], [ 255, 102, 1 ], [ 255, 100, 1 ], [ 255, 99, 1 ], [ 255, 97, 1 ], [ 255, 95, 1 ], [ 255, 93, 1 ], [ 255, 91, 1 ], [ 255, 89, 1 ], [ 255, 87, 1 ], [ 255, 85, 1 ], [ 255, 83, 2 ], [ 255, 81, 2 ], [ 255, 79, 2 ], [ 255, 77, 2 ], [ 255, 76, 2 ], [ 255, 74, 2 ], [ 255, 72, 2 ], [ 255, 70, 2 ], [ 255, 68, 2 ], [ 255, 66, 2 ], [ 255, 64, 2 ], [ 255, 62, 2 ], [ 255, 60, 2 ], [ 255, 58, 2 ], [ 255, 56, 2 ], [ 255, 54, 2 ], [ 255, 52, 2 ], [ 255, 51, 2 ], [ 255, 49, 2 ], [ 255, 47, 2 ], [ 255, 45, 2 ], [ 255, 43, 2 ], [ 255, 41, 2 ], [ 255, 39, 2 ], [ 255, 37, 2 ], [ 255, 35, 2 ], [ 255, 33, 2 ], [ 255, 31, 2 ], [ 255, 29, 2 ], [ 255, 27, 2 ], [ 255, 26, 2 ], [ 255, 24, 2 ], [ 255, 22, 2 ], [ 255, 20, 2 ], [ 255, 18, 2 ], [ 255, 16, 2 ], [ 255, 14, 2 ], [ 255, 12, 2 ], [ 255, 10, 2 ], [ 255, 8, 2 ], [ 255, 6, 2 ], [ 255, 4, 2 ], [ 255, 3, 3 ] ]
// }}}
}

